<?xml version="1.0" encoding="UTF-8"?>
<class xmlns="http://xml.phpdox.net/src#" full="EcommerceTaskMigration" namespace="" name="EcommerceTaskMigration" abstract="false" final="false" start="22" end="1709">
  <file path="./../../../code/tasks" file="EcommerceTaskMigration.php" realpath="/var/www/3.1.photowarehouse.co.nz/ecommerce/code/tasks/EcommerceTaskMigration.php" size="63078" time="2014-08-18T13:51:42+12:00" unixtime="1408326702" sha1="8b8e2c252269747d625bf5b518230d9a20fbb1fa"/>
  <docblock>
    <description/>
    <description compact="This has been placed here rather than in the individual classes for the following reasons: - not to clog up individual classes - to get a complete overview in one class - to be able to run parts and older and newer version without having to go through several clases to retrieve them"/>
    <authors value=": Nicolaas [at] Sunny Side Up .co.nz"/>
    <package value=": ecommerce"/>
    <sub value="-package: tasks"/>
    <inspiration value=": Silverstripe Ltd, Jeremy"/>
    <todo value=": change methods to simple names f10, f20, etc... and then allow individual ones to be run."/>
    <todo value=": 200 + 210 need attention."/>
  </docblock>
  <extends full="BuildTask" namespace="" name="BuildTask"/>
  <member name="limit" type="integer" default="300" visibility="protected" line="24"/>
  <member name="start" type="integer" default="0" visibility="protected" line="26"/>
  <member name="retrieveInfoOnly" type="{unknown}" default="false" visibility="protected" line="28"/>
  <member name="title" type="string" default="&quot;Ecommerce Migration&quot;" visibility="protected" line="30"/>
  <member name="description" type="string" default="&quot;&#13;&#10;&#9;&#9;Migrates all the data from the oldest version of e-commerce to the current one.&#13;&#10;&#9;&#9;Any obsolete fields will be renamed like this: _obsolete_MyField, but not deleted.&#13;&#10;&#9;&quot;" visibility="protected" line="32"/>
  <member name="listOfMigrationTasks" type="array" visibility="protected" line="37"/>
  <method name="run" start="70" end="167" abstract="false" final="false" static="false" visibility="public">
    <parameter name="request" byreference="false" type="{unknown}"/>
    <inline>
      <comment value="can we do the next step?" line="74"/>
      <comment value="IN general yes, but if the current one is not finished yet, then we do it again." line="75"/>
      <comment value="what is the current step?" line="84"/>
      <comment value="are we doing the same one for a different limti?" line="88"/>
      <comment value="NEXT OPTION 1: do again with new limit" line="95"/>
      <comment value="NEXT OPTION 2: start from the beginning" line="102"/>
      <comment value="retrieve data..." line="106"/>
      <comment value="NEXT OPTION 3: next action!" line="125"/>
    </inline>
  </method>
  <method name="hasTableAndField" start="177" end="186" abstract="false" final="false" static="false" visibility="protected">
    <docblock>
      <description compact="Returns true if the table and field (within this table) exist.">Otherwise it returns false.</description>
      <param description="- $field - name of the field to be tested" type="object">
        <type full="String" namespace="" name="String"/>
      </param>
      <param description="- $table - name of the table to be tested" type="object">
        <type full="String" namespace="" name="String"/>
      </param>
      <return type="object">
        <type full="Boolean" namespace="" name="Boolean"/>
      </return>
    </docblock>
    <parameter name="table" byreference="false" type="{unknown}"/>
    <parameter name="field" byreference="false" type="{unknown}"/>
  </method>
  <method name="makeFieldObsolete" start="195" end="207" abstract="false" final="false" static="false" visibility="protected">
    <docblock>
      <description compact="Returns true if the table and field (within this table) exist.">Otherwise it returns false.</description>
      <param description="- $field - name of the field to be tested" type="object">
        <type full="String" namespace="" name="String"/>
      </param>
      <param description="- $table - name of the table to be tested" type="object">
        <type full="String" namespace="" name="String"/>
      </param>
      <return type="object">
        <type full="Boolean" namespace="" name="Boolean"/>
      </return>
    </docblock>
    <parameter name="table" byreference="false" type="{unknown}"/>
    <parameter name="field" byreference="false" type="{unknown}"/>
    <parameter name="format" byreference="false" type="string" default="&quot;&quot;"/>
  </method>
  <method name="shopMemberToMemberTableMigration_10" start="210" end="246" abstract="false" final="false" static="false" visibility="protected"/>
  <method name="moveItemToBuyable_20" start="248" end="271" abstract="false" final="false" static="false" visibility="protected"/>
  <method name="productVersionToOrderItem_25" start="273" end="303" abstract="false" final="false" static="false" visibility="protected"/>
  <method name="productIDToBuyableID_26" start="305" end="383" abstract="false" final="false" static="false" visibility="protected">
    <inline>
      <comment value="we must check for individual database types here because each deals with schema in a none standard way" line="351"/>
      <comment value="can we use Table::has_field ???" line="352"/>
    </inline>
  </method>
  <method name="amountToCalculatedTotal_27" start="385" end="410" abstract="false" final="false" static="false" visibility="protected"/>
  <method name="currencyToMoneyFields_30" start="412" end="465" abstract="false" final="false" static="false" visibility="protected">
    <inline>
      <comment value="ECOMMERCE PAYMENT *************************" line="424"/>
    </inline>
  </method>
  <method name="orderShippingCost_40" start="467" end="504" abstract="false" final="false" static="false" visibility="protected"/>
  <method name="orderTax_45" start="506" end="551" abstract="false" final="false" static="false" visibility="protected"/>
  <method name="orderShippingAddress_50" start="554" end="618" abstract="false" final="false" static="false" visibility="protected"/>
  <method name="orderBillingAddress_51" start="621" end="690" abstract="false" final="false" static="false" visibility="protected"/>
  <method name="memberBillingAddress_52" start="692" end="756" abstract="false" final="false" static="false" visibility="protected"/>
  <method name="moveOrderStatus_60" start="758" end="945" abstract="false" final="false" static="false" visibility="protected">
    <inline>
      <comment value="2) Cancel status update" line="770"/>
    </inline>
  </method>
  <method name="fixBadOrderStatus_68" start="947" end="981" abstract="false" final="false" static="false" visibility="protected"/>
  <method name="updateProductGroups_110" start="984" end="1039" abstract="false" final="false" static="false" visibility="protected">
    <inline>
      <comment value="level of products to show" line="998"/>
      <comment value="default sort order" line="1010"/>
      <comment value="default filter" line="1022"/>
    </inline>
  </method>
  <method name="setFixedPriceForSubmittedOrderItems_120" start="1041" end="1106" abstract="false" final="false" static="false" visibility="protected">
    <inline>
      <comment value="///////////////////////////////" line="1066"/>
      <comment value="/////// We should not include the code below" line="1067"/>
      <comment value="/////// Because it may affect past orders badly." line="1068"/>
      <comment value="///////////////////////////////" line="1069"/>
      <comment value="///////////////////////////////" line="1070"/>
      <comment value="TO DO: WHAT THE HELL IS THAT (true)" line="1081"/>
    </inline>
  </method>
  <method name="moveSiteConfigToEcommerceDBConfig_140" start="1108" end="1164" abstract="false" final="false" static="false" visibility="protected"/>
  <method name="addClassNameToOrderItems_150" start="1166" end="1205" abstract="false" final="false" static="false" visibility="public"/>
  <method name="addTermsAndConditionsMessage_160" start="1207" end="1240" abstract="false" final="false" static="false" visibility="public"/>
  <method name="mergeUncompletedOrderForOneMember_170" start="1242" end="1334" abstract="false" final="false" static="false" visibility="public">
    <inline>
      <comment value="crucial ONLY for non-submitted orders..." line="1266"/>
      <comment value="do nothing!" line="1268"/>
    </inline>
  </method>
  <method name="updateFullSiteTreeSortFieldForAllProducts_180" start="1336" end="1352" abstract="false" final="false" static="false" visibility="public">
    <inline>
      <comment value="level 10" line="1347"/>
    </inline>
  </method>
  <method name="updateOrderStatusLogSequentialOrderNumber_190" start="1354" end="1388" abstract="false" final="false" static="false" visibility="public"/>
  <method name="resaveAllPRoducts_200" start="1390" end="1419" abstract="false" final="false" static="false" visibility="public"/>
  <method name="resaveAllPRoductsVariations_210" start="1421" end="1454" abstract="false" final="false" static="false" visibility="public"/>
  <method name="addConfirmationPage_250" start="1456" end="1495" abstract="false" final="false" static="false" visibility="public"/>
  <method name="cleanupImages_260" start="1497" end="1511" abstract="false" final="false" static="false" visibility="public"/>
  <method name="addNewPopUpManager_280" start="1514" end="1569" abstract="false" final="false" static="false" visibility="public"/>
  <method name="addCurrencyCodeIDToOrders_290" start="1572" end="1590" abstract="false" final="false" static="false" visibility="public"/>
  <method name="MovePaymentToEcommercePayment_300" start="1592" end="1643" abstract="false" final="false" static="false" visibility="public"/>
  <method name="ecommercetaskupgradepickupordeliverymodifier_310" start="1645" end="1661" abstract="false" final="false" static="false" visibility="public"/>
  <method name="ecommercetaskupgradepickupordeliverymodifier_320" start="1663" end="1688" abstract="false" final="false" static="false" visibility="public"/>
  <method name="theEnd_9999" start="1691" end="1702" abstract="false" final="false" static="false" visibility="public"/>
  <method name="DBAlterationMessageNow" start="1704" end="1708" abstract="false" final="false" static="false" visibility="public">
    <parameter name="message" byreference="false" type="{unknown}"/>
    <parameter name="style" byreference="false" type="string" default="&quot;&quot;"/>
  </method>
</class>
